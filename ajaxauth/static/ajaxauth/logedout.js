// Generated by CoffeeScript 1.3.1
(function() {
  var LoginController, SignupController,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; },
    __hasProp = {}.hasOwnProperty,
    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor; child.__super__ = parent.prototype; return child; };

  LoginController = (function(_super) {

    __extends(LoginController, _super);

    LoginController.name = 'LoginController';

    LoginController.prototype.events = {
      'click .login': 'on_login'
    };

    LoginController.prototype.elements = {
      '[name="username"]': 'username',
      '[name="password"]': 'password'
    };

    function LoginController() {
      this.on_login = __bind(this.on_login, this);
      LoginController.__super__.constructor.apply(this, arguments);
      this.login_error = $('#login-error');
      this.login_error.bind('hidden', this.show);
    }

    LoginController.prototype.on_login = function() {
      var is_authenticated;
      this.hide();
      is_authenticated = $.sajax('ajaxauth.login', {
        username: this.username.val(),
        password: this.password.val()
      });
      if (is_authenticated) {
        return document.location.reload();
      } else {
        return this.login_error.modal('show');
      }
    };

    return LoginController;

  })(Boostrap.Modal);

  SignupController = (function(_super) {

    __extends(SignupController, _super);

    SignupController.name = 'SignupController';

    function SignupController() {
      return SignupController.__super__.constructor.apply(this, arguments);
    }

    return SignupController;

  })(Boostrap.Modal);

  $(function() {
    return window.login_controller = new LoginController({
      el: $('#login-dialog')
    });
  });

}).call(this);
